(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(43)},29:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),o=a(15),i=a.n(o),s=(a(29),a(16)),l=a(17),c=a(22),u=a(18),h=a(23),p=a(1),d=a(0),f=a.n(d),y=a(3),A=a.n(y),m=a(19),v=a(20),g=a(2),b=a.n(g),S=a(10),w=a.n(S),C=a(11);a(4);!function(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!==typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===a&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('body {\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",\n    "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue",\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\ncode {\n  font-family: source-code-pro, Menlo, Monaco, Consolas, "Courier New",\n    monospace;\n}\n\n#index_root__4PyOE {\n}\n');var k="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},x=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),O=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},K=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t},I=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)},B={circle:",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACtElEQVRYR+2Wz2sTQRTH5+2mNu2QbJY1Ymuym9nkInjwR/HgQRQVEf8Db9KDB0+K+CfovT0IIuKf4EVBUfSioGD1KJjdndmEEJrY1mQDadjdkZFWSkmT3aQShO5133vfz7z9znsLaMIPTFgfHQD8nx2wLOs6ABQ45/qWhxhCiBWLxRdxPRW5A/V6HXe73UdhGN7AGNclSTqWSCT+6Pm+j8IwrHqedxQAnhFCbgNALwpMJADbts8DwHNVVdV0Oo0A+qdxzlGr1ULr6+utIAiulUqlj8MghgLUarUF3/ff5vP59LBiO99Xq9W2LMsX5ufnVwblDQQol8snpqamPui6Hkt8W5Ax1uacnyWEfN8LYiAApbSZy+U0WZbjHP5vbBAEyHXdhmmaR2IDUErvzs7OPshms9MjqW8lNRqNzU6nc58QstSvzp4dYIx91TTtJMZ4HH3U6XTQ2traF13XF2IBWJYVEkJgL8dHpRI3g1IamqbZ9zv27YBt21eSyeTrubm5qDoD42q1Gur1ehcJIe93B/YFoJQ+yWQyi4qi7AvAxsaGmA+PDcO4FRlAUZTFTCYzGQDLsi7NzMy8mdgnEMfeLxOGYYgYY/FMKAAYYyuapp2a2DV0HOcOxvjhuINodXW11+127xmGsRxrDohgx3Ga+Xx+5FEs1nSlUmmappmNPYpFAqX0OELok2EYqVGug+u6nu/7p4vF4o+RALa8cAYh9E7X9VgQruv+Eus4l8t9G3kdbyeWy+Vzsiy/VFVVSaVSSJKkvjWF49vttpj9bYTQZdM0Pw/r3NAfku0CnPNDtm0vAcBNjHETAIQ3psWu8H1/k3P+0/O8w5IkPS0UCuKXLBwmLt5HBthZzHGcq0EQFADA4JwLIVeWZUYIeRVFdGfMSABxRcb2wH4KRlpG/1LwAGB3B34DBWQWMG24djEAAAAASUVORK5CYII=",cross:",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA50lEQVRYR+2XPQ6DMAyF8QZbfIYchN4spRer6D1yBcyWbKmylZI4WB0oklmdn8cnvfcAupMfOPn+7noCvPeOo2atnSRURQTy5cMwuL7vi/tijCmE8LDW3o+KEAtARIeIxX1ElIhIBSiBixNo+HxExBvngmVZXgDwrNnwOyc2dmr5PB+KiKzFiag6L+XETgDn86PhUltXygkVoAT+jwBXt7/aMITQxRinz7re1ar3vtrlADAaY3IYVet4Xdc5pTQzQbQ5X78HlIASEBPgcqLk81aDigTkw7icyHPJP0FeLxbQeiPpXAW8AUg5MTAvQNb8AAAAAElFTkSuQmCC",diamond:",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACaElEQVRYR9WXy4vTUBTG05DW2E7sI6XPlOTeUkTcqeB2QHApIrgTXIr+AbrVlW5cKbidlStFXKsrl+IsB4T23tiGtolp2pLbTh9JkQwpjNppmkyHYFaB3POdX777OidCBXwQQhdpmv5GUdRisVhchxD+CCIVCRLkxGCMv+fz+SvOu6qq+wCAq0G0AgHU6/Xb8Xh8r1gsJp2knU5nOJ1O7wMAPvqFCASAMTYEQUgzDHOUz7IsqtVq9SGEmTMHwBg/5TjuCc/z7PFkvV5vYprmCwDAMz8QvhzQNG2HEKIDAM6tSoIxnrEsmy6VSuNNIXwBYIzf8zx/h+O4lfqmaVKGYbyTJOnu1gEajca1aDT6pVKpXFgnriiKadv2riRJ+5tAbOwAxvigUChcYtk/pv6fHJPJhOp2uwcAgMtbA0AI3UskEm9yudzOJqKqqpLRaPSgWq2+9Rq/kQMIoUNRFFmapr30jr7btk01m80xhDDhFeAJgBB6mUqlHqbT6fNeYse/9/v9w8Fg8BpC+Hhd3FoAjHEhEok0RFGM+0m+HCvL8tiyLKlWq/06KX4tgCzLn7PZ7I1EwtPJlfqEEErX9U8AgJu+ATDGuwzDfBAEIRXk75cxiqIM5vP5LQjh11U6JzqAEGqWy+VKLBY7TX5qNptR7Xb7JwBA+r8AQp8Cx65QF6EDEPo2dCCcgyiZTD7KZDLrL4G/VphhGJPhcPjqVAfRUjPUo9h1wddlpGkaIYRs7zJy10N417EDEHpB4roQXknmAIRelLourCzLdV2fEkKen2lZvtyWoTYmDkTorZk7FeE1p+7htJX2/DfV7WYwLPkGlAAAAABJRU5ErkJggg==",square:",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAp0lEQVRYR+2WMQ4CIRBFWQoyFQ03YG7naqPHsNEY9XLADSjooFrD1mJixmRj8qlh/ssbij+pjc+0cb4CAAx8NBBCOGitjfCjVu/9fTRjCNDDiehKRKI1tdaWWuuemR/vIIbDU0ona+3ZOScCyDkvpZQjM18AAAMwAAMwAAMw8HcGZmPM7UeFZGbm51cG+uUY404pJa1kbRTeM0RtR9gV1+cAgIHNDbwAdNviIRMkcw0AAAAASUVORK5CYII=","triangle-down":",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC2klEQVRYR+2WPWzTQBiGnR/iFrs4pFadpolyn09VJZAYOjDQCYmFiYVKIDHQgRWxMCAhIaSuHWCEAXWknZAQG1IHJAbEAggGcpc4bVK3Sdu0SUwSXBu5clHTpk7sJC0D3uLcfe9z730/9jGn/PhOWZ/5dwAURblgGEbiJBzx+XxZhNAPS+uvA5RSJRQK8f0GME3Tp+v6NgBAEwAh5DbHcS8lSeL6CbG2tlbVNG1GluXFJgDrRyaT+SZJ0sWBgYG+MNRqNUZV1a8AcGlfoCkJM5nMZCAQWIrH40P9IFheXq7ouj4ly/KXlgC2C4uRSOTm0FBvGXZ2dpjNzc3XAHDr4OGOlGE+nz9bq9W2ACDUSxcopbphGPz4+HjdEcD6M51OP+F5/pEoimwvIIrFYr1cLs/Ksjx7ON6xjSidTm/E4/FIMBjsikHXdWZlZWUDAMRWgZwAbrAsOz86Oip0Q6Cq6ramaXcwxm9dAdhX8VmSpMnBwUFPDJqmMcVi8VMymbx8XADHWUApnfD7/VYATyWRzWatspvEGP/0BGBtUhRlXhCEaUEQXNlQKpV+lUqlBQC462RfR9OQEGLKsuzqGiilDMa4bfy2C+zm9JDjuMeiKJ7rhKJQKJQ1TXuKEJprt74jADshV2OxWDQUcu5PjUaDyefzqwAQayd+ZBg5bSCEXGNZdmFsbOy807pcLrdVr9enMcbvewpgJ+SH4eHhKY5rPbGr1SpTKBSWAOBqJ+KuHLAWp1KpRDAY/J5MJlt+uCiKUg0EAhOJRCLXFwA7F56Fw+F74XC4qSztsnsBAA86FXftwH5gQkgDIXTG7/fvvTIMw/qY+Y0xdj1BO66Cg6cihMzwPP98ZGRk7yrW19crlUrlPsb4lZvTe3bA7g0kGo3udSdVVSlCCLsV7woglUpdYVn2nRVkd3f3OkLo44kC2GX5xjRNKx+mvYh35YBXwcP7PCVhr8T/O2A58AfGZw8wtSahoQAAAABJRU5ErkJggg==","triangle-up":",iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC3UlEQVRYR+2VP2gTURzHLyG5tOnFXD0uJsTj3u9dB4s4iIIOIk5uDnUQQdChuApOBScFh4KDg4uDOgkKKoKO4iAI4lIciiD03rtoSnOJTbzcJTmS651EraTm312a2qVvvd/v+/2873vvdyFml1dol/2ZPYBtJUApfdk+QgCYG/UoRwZQVfVULBZ77Xke02w2zymK8n4UiJEBKKU0k8mgtmmhUKAIIfzfAAgh8xzH3RVFMdE2LRaLZq1Wu44xfhgUYqQEVFVtAUAkFPrd7rouo2maoyhKdMcBCCH3eJ6fn56enuw0q1QqjWq1+gAhdC0IRKAECCFyOBxelmWZ62WSy+WsjY2Nw4qifPULEQhA07QPoiiejMfjPfVrtRpTKpXeAcCZsQMQQs6yLPskm83uHyS+urpabjabFzHGb/xA+E6AUlrIZrMHotHB96zVajH5fF7HGKfHBkApXZiamrohiuI+P6KlUqlar9dvI4TuDKsfmoDneWFCSAtjHB4m1vmdEOIpijK0ZyiApmmPeZ6fSyaTvW9eHyrDMOqGYTyXZfnKIPCBAJqmzTIM81GW5V8TL+jK5XKG67onMMZf+vUOA1hKpVJHJye3zBzfHI1Gg9F1fQkAjgUGWFlZmYvH448ymQzv27FH4drammHb9mWM8ateOn0TIIRUJEniI5HIdvwZx3Haz7IMAIJvAErpzUQisSAIwsS23P80r6+v26ZpLgLArX/1uhIoFoucZVnfASA2DvNNjfZTZlk2KUlSo1O3C4BS+kIQhPOJxEgXvy+zaZpMuVx+hhC60BdAVdXj0Wj0rSRJviZe0ITy+bzpOM5pAPi02bslAUrp53Q6PTsxMZaj7+Kzbbv9LJcRQke6AFRVvcRx3P1UKtXzXx90t/3qdV23LMu6OjMz87Rd8zcBQojGsuyORN8J43leyHGcHwAAWwAopYdc1z04rp0OnP+h0LfN8Tz0Z7TTQHsAPwHv3BIw9zTkUQAAAABJRU5ErkJggg=="},U=function(){function e(t){E(this,e),this.symbolType=t}return x(e,[{key:"load",value:function(){var e=new Image;e.src="data:image/png;base64"+B[this.symbolType];var t=new p.p(e);return t.needsUpdate=!0,t}}]),e}();var R="other";function T(e){var t="undefined"===typeof e?"undefined":k(e);return"number"===t&&(t="int",Number.isInteger(e)||(t="float")),t}function D(e,t){for(var a=new Array(e.length),n=0;n<e.length;n++)a[n]=e[t[n]];return a}function P(e,t){var a=b.a.countBy(e);a=b.a.sortBy(b.a.pairs(a),function(e){return-e[1]});for(var n=b.a.map(a.slice(0,t),function(e){return e[0]}),r=0;r<e.length;r++)-1===n.indexOf(e[r])&&(e[r]=R);return e}function M(e,t){for(var a=A.a.extent(e),n=parseFloat(a[0]),r=parseFloat(a[1]),o=(r-n)/t,i=b.a.range(1,t).map(function(e){return e*o+n}),s=[n.toFixed(2)+" to "+i[0].toFixed(2)],l=0;l<t-1;l++){if(l===t-2)var c=i[l].toFixed(2)+" to "+r.toFixed(2);else c=i[l].toFixed(2)+" to "+i[l+1].toFixed(2);s.push(c)}return{labels:s,domain:i,min:n,max:r,interval:o}}function V(e,t){for(var a=A.a.extent(e),n=parseFloat(a[0]),r=parseFloat(a[1]),o=["0 to "+t[0]],i=t.length,s=0;s<i-1;s++){var l=t[s]+" to "+t[s+1];o.push(l)}return{labels:o,domain:t.slice(0,-1),min:n,max:r}}var z=function(){function e(t){E(this,e),this.data=t,this.n=t.length;var a=this.getIndicesAndPositions(t),n=a.indices,r=a.positions;this.indices=n,this.positions=r}return x(e,[{key:"getIndicesAndPositions",value:function(e){for(var t=this.n,a=new Uint32Array(t),n=new Float32Array(3*t),r=0;r<t;r++)a[r]=r,n[3*r]=e[r].x,n[3*r+1]=e[r].y,n[3*r+2]=e[r].z||0;return{indices:a,positions:n}}},{key:"getAttr",value:function(e){return this.data.map(function(t){return t[e]})}}]),e}(),G=function(){function e(t){E(this,e),this.model=t.model,this.geometry=null,this.createGeometry()}return x(e,[{key:"createGeometry",value:function(){var e=new p.b,t=this.model;e.setIndex(new p.a(t.indices,1)),e.addAttribute("position",new p.a(t.positions,3)),e.userData={index:t.getAttr("index")},e.computeBoundingSphere(),this.geometry=e}}]),e}(),H=function(){function e(t){E(this,e),this.data=t,this.n=t.length,this.metas=[],this.parse();var a=this.getIndicesAndPositions(),n=a.indices,r=a.positions;this.indices=n,this.positions=r}return x(e,[{key:"parse",value:function(){var e=this,t=this.data,a=["x","y","z"],n=function(n){if(-1===a.indexOf(n)){var r=t.map(function(e){return e[n]}),o=[].concat(I(new Set(r))).length,i=T(t[0][n]);e.metas.push({name:n,nUnique:o,type:i})}},r=!0,o=!1,i=void 0;try{for(var s,l=Object.keys(t[0])[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){n(s.value)}}catch(c){o=!0,i=c}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}}},{key:"getIndicesAndPositions",value:function(){for(var e=this.n,t=new Uint32Array(e),a=new Float32Array(3*e),n=0;n<e;n++)t[n]=n,a[3*n]=this.data[n].x,a[3*n+1]=this.data[n].y,a[3*n+2]=this.data[n].z||0,this.data[n].index=n;return{indices:t,positions:a}}},{key:"getLabels",value:function(e){var t=this.n,a=new Array(t),n=0,r=!0,o=!1,i=void 0;try{for(var s,l=this.data[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value,u="",h=!0,p=!1,d=void 0;try{for(var f,y=e[Symbol.iterator]();!(h=(f=y.next()).done);h=!0){var A=f.value;u+="Time"===A?A+": "+c[A]+" hours\n":"Dose"===A?A+": "+c[A]+" \u03bcM\n":A+": "+c[A]+" \n"}}catch(m){p=!0,d=m}finally{try{!h&&y.return&&y.return()}finally{if(p)throw d}}a[n]=u,n++}}catch(m){o=!0,i=m}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return a}},{key:"groupBy",value:function(e){var t=b.a.groupBy(this.data,e);return b.a.mapObject(t,function(e,t){return new z(e)})}},{key:"binBy",value:function(e,t){var a=function(e,t,a){var n=M(b.a.pluck(e,t),a),r=n.labels,o=n.min,i=n.interval;return b.a.groupBy(e,function(e){var n=Math.floor((e[t]-o)/i);return n===a&&(n=a-1),r[n]})}(this.data,e,t);return b.a.mapObject(a,function(e,t){return new z(e)})}},{key:"binBy2",value:function(e,t){var a=function(e,t,a){var n=V(b.a.pluck(e,t),a).labels;return b.a.groupBy(e,function(e){var r=b.a.filter(a,function(a){return a<e[t]}).length;return n[r]})}(this.data,e,t);return b.a.mapObject(a,function(e,t){return new z(e)})}},{key:"getAttr",value:function(e){return this.data.map(function(t){return t[e]})}},{key:"setAttr",value:function(e,t){for(var a=0;a<this.n;a++){var n=this.data[a];n[e]=t[a],this.data[a]=n}this.metas.push({name:e,nUnique:[].concat(I(new Set(t))).length,type:T(t[0])})}},{key:"getColorOptions",value:function(){var e=this,t=this.metas.filter(function(t){return t.nUnique<e.n&&t.nUnique>1});return t=t.map(function(e){return{value:e.name,label:e.name}})}},{key:"getShapeOptions",value:function(){var e=this.metas.filter(function(e){return"float"!==e.type&&e.nUnique<7&&e.nUnique>1});return e=e.map(function(e){return{value:e.name,label:e.name}})}},{key:"calculateColorScale",value:function(e){var t=this.getAttr(e),a=b.a.findWhere(this.metas,{name:e}),n=a.type;"float"!==n&&"int"!==n&&a.nUnique>20&&(t=P(t,19));var r=new Set(t),o=r.size;if(-1!==(r=Array.from(r)).indexOf("unknown")&&r.length>7){var i=r.indexOf("unknown"),s=7;20===r.length&&(s=15);var l=r[s];r[s]="unknown",r[i]=l}if(-1!==r.indexOf(R)&&20===r.length){var c=r.indexOf(R),u=15;-1!==r.indexOf("unknown")&&(u=14);var h=r[u];r[u]=R,r[c]=h}var p=A.a.extent(t),d=p[0],f=p[1],y=A.a.scale.pow().domain([d,(d+f)/2,f]).range(["#1f77b4","#ddd","#d62728"]);if("Scores"===a.name||"R2_Score"===a.name)p=A.a.extent(t),y=A.a.scale.pow().domain([p[0],0,p[1]]).range(["#1f77b4","#ddd","#d62728"]);else if("boolean"===n)y=A.a.scale.ordinal().domain([!0,!1]).range(["#cc0000","#cccccc"]);else if(o<11)y=A.a.scale.category10().domain(r);else if(o>10&&o<=20)y=A.a.scale.category20().domain(r);else if(o<=40){y=A.a.scale.ordinal().range(["#1b70fc","#faff16","#d50527","#158940","#f898fd","#24c9d7","#cb9b64","#866888","#22e67a","#e509ae","#9dabfa","#437e8a","#b21bff","#ff7b91","#94aa05","#ac5906","#82a68d","#fe6616","#7a7352","#f9bc0f","#b65d66","#07a2e6","#c091ae","#8a91a7","#88fc07","#ea42fe","#9e8010","#10b437","#c281fe","#f92b75","#07c99d","#a946aa","#bfd544","#16977e","#ff6ac8","#a88178","#5776a9","#678007","#fa9316","#85c070","#6aa2a9","#989e5d","#fe9169","#cd714a","#6ed014","#c5639c","#c23271","#698ffc","#678275","#c5a121","#a978ba","#ee534e","#d24506","#59c3fa","#ca7b0a","#6f7385","#9a634a","#48aa6f","#ad9ad0","#d7908c","#6a8a53","#8c46fc","#8f5ab8","#fd1105","#7ea7cf","#d77cd1","#a9804b","#0688b4","#6a9f3e","#ee8fba","#a67389","#9e8cfe","#bd443c","#6d63ff","#d110d5","#798cc3","#df5f83","#b1b853","#bb59d8","#1d960c","#867ba8","#18acc9","#25b3a7","#f3db1d","#938c6d","#936a24","#a964fb","#92e460","#a05787","#9c87a0","#20c773","#8b696d","#78762d","#e154c6","#40835f","#d73656","#1afd5c","#c4f546","#3d88d8","#bd3896","#1397a3","#f940a5","#66aeff","#d097e7","#fe6ef9","#d86507","#8b900a","#d47270","#e8ac48","#cf7c97","#cebb11","#718a90","#e78139","#ff7463","#bea1fd"]).domain(r)}return y}},{key:"calculateShapeScale",value:function(e){var t=A.a.svg.symbolTypes.map(function(e){return A.a.svg.symbol().type(e)()}),a=b.a.findWhere(this.metas,{name:e}),n=this.groupBy(e),r=void 0,o=A.a.scale.ordinal().domain(Object.keys(n)).range(t);if(-1!==["int","float"].indexOf(a.type)&&a.nUnique>6){n=this.binBy(e,6);var i=M(b.a.pluck(this.data,e),6);if("p-value"===a.name){var s=[.001,.01,.05,.1,1];n=this.binBy2(e,s);V(b.a.pluck(this.data,e),s),b.a.map(A.a.svg.symbolTypes.slice(0,s.length),function(e){return A.a.svg.symbol().type(e)()})}o=A.a.scale.threshold().domain(i.domain).range(t),r=i.labels}return{shapeScale:o,shapeLabels:r,scatterDataSubsets:n}}}]),e}(),Q=function(e){function t(e){E(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=a.props.is3d;return a.state={isLoading:!1,isLoaded:!1,url:a.props.url,data:a.props.data,model:null,WIDTH:a.props.width||1400,HEIGHT:a.props.height||800,DPR:a.props.DPR||2,labelKeys:a.props.labelKeys,colorKey:a.props.colorKey,shapeKey:a.props.shapeKey,pointSize:n?.5:12,showStats:!1,is3d:n,colorScale:a.props.colorScale,shapeScale:a.props.shapeScale,shapeLabels:a.props.shapeLabels},a.handleMouseMove=a.handleMouseMove.bind(a),a}return O(t,e),x(t,[{key:"componentDidMount",value:function(){var e=this;this.props.url&&(this.setState({isLoading:!0}),fetch(this.props.url).then(function(e){if(e.ok)return e.json();throw new Error("Something went wrong when fetching data ...")}).then(function(t){e.setState({data:t,model:new H(t),isLoading:!1,isLoaded:!0}),e.makeMaterial(),e.setUpStage(),e.shapeBy(e.state.shapeKey),e.renderScatter()}))}},{key:"componentDidUpdate",value:function(e,t,a){this.props.url||(null===t.data&&null===e.data&&null!==this.props.data&&null===this.state.data?(this.makeMaterial(),this.setUpStage()):null!==this.props.data&&null!==this.props.shapeScale?(this.shapeBy(this.props.shapeKey),this.renderScatter()):this.props.colorKey!==e.colorKey&&this.renderScatter())}},{key:"render",value:function(){var e=this;return f.a.createElement("div",{ref:function(t){return e.mount=t},onMouseMove:function(t){return e.handleMouseMove(t)}})}},{key:"setUpStage",value:function(){var e=this,t=this.state,a=t.WIDTH,n=t.HEIGHT,r=t.DPR,o=a/n,i=new p.n,s=new p.t;s.setClearColor(16777215),s.setPixelRatio(r),s.setSize(a,n);var l=-10.5,c=10.5,u=-10.5,h=10.5;o>1?(l*=o,c*=o):(h/=o,u/=o);var d=new p.h(l,c,h,u,-1e3,1e3);this.state.is3d&&((d=new p.i(70,o,.01,1e6)).position.z=30),s.domElement.id="renderer",this.mount.appendChild(s.domElement),this.mount.style.position="relative",this.mount.style.padding=0;var f=new m.a(d,s.domElement);f.enableZoom=!0,f.screenSpacePanning=!0,this.state.is3d||(f.enableRotate=!1,f.mouseButtons={LEFT:p.g.RIGHT,MIDDLE:p.g.DOLLY,RIGHT:p.g.LEFT}),f.addEventListener("change",function(t){e.renderScatter()});var y=new p.m;this.state.raycasterThreshold?y.params.Points.threshold=this.raycasterThreshold:this.state.is3d?y.params.Points.threshold=this.state.pointSize/5:y.params.Points.threshold=this.state.pointSize/500;var A=new p.q;this.scene=i,this.renderer=s,this.camera=d,this.controls=f,this.raycaster=y,this.mouse=A}},{key:"handleMouseMove",value:function(e){var t=this.mouse,a=this.state,n=a.WIDTH,r=a.HEIGHT;t.x=e.nativeEvent.offsetX/n*2-1,t.y=-e.nativeEvent.offsetY/r*2+1,this.mouse=t,this.renderScatter()}},{key:"makeMaterial",value:function(){var e=[],t=!0,a=!1,n=void 0;try{for(var r,o=["circle","cross","diamond","square","triangle-down","triangle-up"][Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,s=new U(i).load(),l=new p.k({vertexColors:p.s,size:this.state.pointSize,sizeAttenuation:this.state.is3d,map:s,alphaTest:.2,transparent:!0,opacity:.6});e.push(l)}}catch(c){a=!0,n=c}finally{try{!t&&o.return&&o.return()}finally{if(a)throw n}}this.materials=e}},{key:"clearScene",value:function(){var e=this.scene,t=!0,a=!1,n=void 0;try{for(var r,o=e.children[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;e.remove(i)}}catch(s){a=!0,n=s}finally{try{!t&&o.return&&o.return()}finally{if(a)throw n}}}},{key:"shapeBy",value:function(e){var t=this.props.model,a=this.scene,n=t.calculateShapeScale(e),r=(n.shapeScale,n.shapeLabels,n.scatterDataSubsets),o=[],i=!0,s=!1,l=void 0;try{for(var c,u=Object.keys(r)[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var h=c.value,d=new G({model:r[h]});o.push(d.geometry)}}catch(w){s=!0,l=w}finally{try{!i&&u.return&&u.return()}finally{if(s)throw l}}var f=v.a.mergeBufferGeometries(o),y=o.map(function(e){return e.userData.index}).reduce(function(e,t){return e.concat(t)}),A=t.getLabels(this.state.labelKeys);A=D(A,y),f.userData={index:y,labels:A};var m=o.map(function(e){return e.index.length}),g=m.reduce(function(e,t,a){return[].concat(I(e),[t+(e[a-1]||0)])},[]);g.unshift(-1);for(var b=0;b<o.length;b++)f.addGroup(g[b]+1,m[b],b);var S=new p.j(f,this.materials);this.clearScene(),a.add(S),this.points=S,this.setColors(this.props.colorScale,this.props.colorKey)}},{key:"renderScatter",value:function(){var e=this.raycaster,t=this.mouse,a=this.camera,n=this.renderer,r=this.scene;e.setFromCamera(t,a);var o=e.intersectObjects([this.points]);this.resetColors();var i=document.getElementById("text-label");if(i&&i.remove(),o.length>0){var s=o[0],l=s.index,c=s.object.geometry;c.attributes.color.needsUpdate=!0,c.attributes.color.array[3*l]=.1,c.attributes.color.array[3*l+1]=.8,c.attributes.color.array[3*l+2]=.1;var u={x:c.attributes.position.array[3*l],y:c.attributes.position.array[3*l+1],z:c.attributes.position.array[3*l+2]},h=this.makeTextCanvas(c.userData.labels[l],u.x,u.y,u.z,{fontsize:24,fontface:"arial, sans-serif",textColor:{r:0,g:0,b:0,a:.8}});h.id="text-label",this.mount.appendChild(h)}n.render(r,a)}},{key:"makeTextCanvas",value:function(e,t,a,n,r){void 0===r&&(r={});var o=r.hasOwnProperty("fontface")?r.fontface:"arial, sans-serif",i=r.hasOwnProperty("fontsize")?r.fontsize:18,s=r.hasOwnProperty("textColor")?r.textColor:{r:0,g:0,b:255,a:.8},l=r.hasOwnProperty("lineHeight")?r.lineHeight:20,c=document.createElement("canvas"),u=c.getContext("2d"),h=this.state,d=h.WIDTH,f=h.HEIGHT;c.width=d,c.height=f,u.font=i+"px "+o,u.textBaseline="alphabetic",u.textAlign="left";var y;u.measureText(e);u.fillStyle="rgba("+(y=s).r+","+y.g+","+y.b+","+y.a+")";for(var A=new p.r(t,a,n),m=(new p.r).copy(A).project(this.camera),v={x:(m.x+1)/2*d,y:-(m.y-1)/2*f},g=e.split("\n"),b=0;b<g.length;b++)u.fillText(g[b],v.x,v.y+b*l);return c.style.left=0,c.style.top=0,c.style.position="absolute",c.style.pointerEvents="none",c}},{key:"resetColors",value:function(){this.setColors(this.props.colorScale,this.props.colorKey)}},{key:"setColors",value:function(e,t){var a=this.props.model,n=a.getAttr(t),r=this.points.geometry;n=D(n,r.userData.index);var o=b.a.findWhere(a.metas,{name:t}),i=o.type;"float"!==i&&"int"!==i&&o.nUnique>20&&(n=P(n,19));var s=new Float32Array(3*a.n),l={length:2};e.hasOwnProperty("domain")&&(l=e.domain().slice());for(var c=n.length-1;c>=0;c--){var u=e(n[c]);(u=new p.c(u)).toArray(s,3*c)}if(l.length>3)for(var h=n.length-1;h>=0;h--){var d=e(n[h]);-1===l.indexOf(n[h])&&(d=e(R)),(d=new p.c(d)).toArray(s,3*h)}r.addAttribute("color",new p.a(s.slice(),3))}}]),t}(f.a.Component),F=function(e){function t(e){E(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={width:a.props.width||300,height:a.props.height||800},a}return O(t,e),x(t,[{key:"componentDidMount",value:function(){this.setUpDOMs()}},{key:"componentDidUpdate",value:function(e,t,a){e.colorScale!==this.props.colorScale&&this.displayColorLegend(this.props.colorScale,this.props.colorKey),e.shapeScale!==this.props.shapeScale&&this.displayShapeLegend(this.props.shapeScale,this.props.shapeKey,this.props.shapeLabels)}},{key:"render",value:function(){var e=this;return f.a.createElement("div",{ref:function(t){return e.mount=t}})}},{key:"setUpDOMs",value:function(){var e=this.state,t=e.width,a=e.height;this.el=A.a.select(this.mount).append("svg").attr("id","legend").attr("width",t).attr("height",a),this.g=this.el.append("g").attr("class","legend").attr("transform","translate(10, 20)"),this.g.append("g").attr("id","legendShape").attr("class","legendPanel").attr("transform","translate(0, 0)"),this.g.append("g").attr("id","legendColor").attr("class","legendPanel").attr("transform","translate(110, 0)"),this.mount.style.position="absolute",this.mount.style.zIndex=10,this.mount.style.overflow="visible",this.mount.style.left=0,this.mount.style.top=0}},{key:"displayShapeLegend",value:function(e,t,a){var n=w.a.symbol().scale(e).orient("vertical").title(t);a&&n.labels(a),this.g.select("#legendShape").call(n)}},{key:"displayColorLegend",value:function(e,t){var a=w.a.color().title(t).shapeWidth(20).cells(5).labelFormat(A.a.format(".2f")).scale(e);this.g.select("#legendColor").call(a)}}]),t}(f.a.Component),L=function(e){function t(e){E(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={label:a.props.label,options:null,defaultValue:a.props.defaultValue},a.handleChange=a.handleChange.bind(a),a}return O(t,e),x(t,[{key:"componentDidMount",value:function(){this.mount.style.zIndex=10,this.mount.style.width="200px"}},{key:"render",value:function(){var e=this;return f.a.createElement("div",{ref:function(t){return e.mount=t}},f.a.createElement("label",null,this.props.label),f.a.createElement(C.a,{defaultValue:this.state.defaultValue,options:this.props.options,onChange:this.handleChange}))}},{key:"handleChange",value:function(e){this.props.onSelectChange(e)}}]),t}(f.a.Component),j=(function(e){function t(e){E(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={searchStr:""},a.handleChange=a.handleChange.bind(a),a}O(t,e),x(t,[{key:"render",value:function(){var e=this;return f.a.createElement("div",{ref:function(t){return e.mount=t}},f.a.createElement("label",null,this.props.label),f.a.createElement(C.a,{defaultValue:"",defaultInputValue:"",onChange:this.handleChange}))}},{key:"handleChange",value:function(e){this.props.onInputChange(e)}}])}(f.a.Component),function(e){function t(e){E(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={data:null,model:null,colorScale:null,shapeScale:null,shapeLabels:null,colorKey:a.props.colorKey,shapeKey:a.props.shapeKey,labelKeys:a.props.labelKeys,is3d:a.props.is3d},a.handleColorKeyChange=a.handleColorKeyChange.bind(a),a.handleShapeKeyChange=a.handleShapeKeyChange.bind(a),fetch(a.props.url).then(function(e){if(e.ok)return e.json();throw new Error("Something went wrong when fetching data ...")}).then(function(e){return a.setState({data:e,model:new H(e)})}),a}return O(t,e),x(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.colorKey,n=t.shapeKey,r=t.labelKeys,o=t.is3d,i=this.state,s=i.colorScale,l=i.shapeScale,c=i.shapeLabels,u=null,h=null;return this.state.model&&(u=this.state.model.getColorOptions(),h=this.state.model.getShapeOptions()),f.a.createElement("div",null,f.a.createElement(Q,{data:this.state.data,model:this.state.model,width:1400,height:800,DPR:window.devicePixelRatio,colorKey:a,shapeKey:n,labelKeys:r,colorScale:s,shapeScale:l,shapeLabels:l,is3d:o,ref:function(t){e.scatter3dView=t}}),f.a.createElement(F,{colorScale:s,colorKey:a,shapeScale:l,shapeKey:n,shapeLabels:c}),f.a.createElement("div",{style:{zIndex:10,top:0,right:0,width:200,position:"absolute"}},f.a.createElement(L,{label:"Color by:",defaultValue:{value:a,label:a},options:u,onSelectChange:this.handleColorKeyChange}),f.a.createElement(L,{label:"Shape by:",defaultValue:{value:n,label:n},options:h,onSelectChange:this.handleShapeKeyChange})))}},{key:"handleColorKeyChange",value:function(e){var t=e.value;if(t!==this.state.colorKey){var a=this.state.model.calculateColorScale(t);this.setState({colorKey:t,colorScale:a})}}},{key:"handleShapeKeyChange",value:function(e){var t=e.value;if(t!==this.state.shapeKey){var a=this.state.model.calculateShapeScale(t),n=a.shapeScale,r=a.shapeLabels;this.setState({shapeKey:t,shapeScale:n,shapeLabels:r})}}},{key:"componentDidUpdate",value:function(e,t){if(null===t.data&&t.data!==this.state.data){var a=this.state,n=a.colorKey,r=a.shapeKey,o=this.state.model,i=o.calculateColorScale(n),s=o.calculateShapeScale(r),l=s.shapeScale,c=s.shapeLabels;this.setState({colorScale:i,shapeScale:l,shapeLabels:c})}}}]),t}(f.a.Component)),q=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(j,{url:"https://amp.pharm.mssm.edu/l1000fwd/graph/A549_kNN_5",shapeKey:"Time",colorKey:"MOA",labelKeys:["sig_id"]})}}]),t}(n.Component);i.a.render(r.a.createElement(q,null),document.getElementById("root"))}},[[24,2,1]]]);
//# sourceMappingURL=main.cb00e973.chunk.js.map